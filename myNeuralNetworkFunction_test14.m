function [Y,Xf,Af] = myNeuralNetworkFunction_test14(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-Jan-2019 17:38:04.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 100xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 4xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100];
x1_step2.xoffset = [2.3166465765103e-06;4.63676132156917e-06;6.95687606530545e-06;9.27699080771914e-06;1.15971055488102e-05;1.39172202885787e-05;1.62373350270247e-05;1.8557449764148e-05;2.08775644999487e-05;2.31976792344268e-05;2.55177939675824e-05;2.78379086994154e-05;3.01580234299257e-05;3.24781381591135e-05;3.47982528869787e-05;3.71183676135213e-05;3.94384823387413e-05;4.17585970626387e-05;4.40787117852135e-05;4.63988265064657e-05;4.87189412263954e-05;5.10390559450024e-05;5.33591706622869e-05;5.56792853782487e-05;5.7999400092888e-05;6.03195148062047e-05;6.26396295181988e-05;6.49597442288702e-05;6.72798589382191e-05;6.95999736462455e-05;7.19200883529492e-05;7.42402030583303e-05;7.65603177623888e-05;7.88804324651248e-05;8.12005471665381e-05;8.35206618666289e-05;8.58407765653971e-05;8.81608912628427e-05;9.04810059589656e-05;9.2801120653766e-05;9.51212353472439e-05;9.74413500393991e-05;9.97614647302317e-05;0.000102081579419742;0.000104401694107929;0.000106721808794794;0.000109041923480336;0.000111362038164556;0.000113682152847453;0.0519011786204565;-2.08122341217558;-2.07985521514475;-4.64631192846799;-3.87975175734378;-1.91368444826347;-0.275934504902748;-0.00440750210537955;-1.29956009123501;-2.17515806997928;-2.85069610875528;-3.69999776106257;-4.05235599002914;-4.38826925884144;-4.64014314995179;-4.45792416698981;-3.90176755636985;-3.05863519794012;-3.06582133693641;-3.72380404530821;-4.19091363085909;-4.4624718163313;-4.54171880487045;-4.43912959489885;-4.17149770411579;-4.25496524260429;-4.42128866965174;-4.58931382874538;-4.83753159392139;-4.95352208061577;-4.94827251951794;-4.83432094013273;-4.62532048328216;-4.33562373612021;-3.97989421454647;-3.57275078857933;-3.12844952518106;-2.6606061385336;-2.18196101445453;-1.70418763425534;-1.23774418068236;-0.791767177547611;-0.613464438004896;-0.626318554994336;-0.629179527426735;-0.623455945422867;-0.714144793026958;-0.930043790320416;-1.02085143676597];
x1_step2.gain = [0.305445975387538;0.147120483609261;0.102762329877197;0.0821782282476107;0.0704543941411909;0.0629891792100725;0.0578932258430521;0.0542473531439033;0.05155042462912;0.049505814484334;0.0479266803893353;0.0466894656781398;0.0457092201317776;0.0449256574973924;0.0442948649633633;0.0437841573873234;0.0433687644545174;0.0430296293331398;0.0427519048614646;0.0425239008507334;0.0423363310392836;0.0421817639168434;0.0420542152932279;0.0419488413802142;0.0418617044435783;0.0410791105912499;0.0401570892826291;0.0393061179010711;0.0385187818316157;0.0377886583069602;0.0371101558133419;0.0364783837257966;0.0358890457361936;0.0353383521575026;0.03482294731554;0.0343398490843093;0.0338863982597105;0.0334602159533024;0.0330591675619805;0.0326813321591649;0.0323249763790264;0.0319885320426597;0.0316657072579138;0.0311790799401527;0.0307151019767634;0.0302722919346436;0.0298492945610242;0.0294448676249997;0.0290578703721287;0.042846124450848;0.0407955958398983;0.0408506224732742;0.0388658301423054;0.0395051025156438;0.0411571362236137;0.0425827386485798;0.0427760358396384;0.0416026207128584;0.0408512286754388;0.0402932884320644;0.0396156309791217;0.039342084587811;0.0390851977366923;0.0388952542224259;0.0390351527462613;0.0394651577928845;0.0401345576539695;0.0401304776685122;0.0396092203877567;0.0392477923337376;0.0390413665951746;0.0389826780689261;0.0390624040861008;0.0392693001231507;0.0392066806044071;0.0390808842559122;0.0389546013016256;0.0387687724871784;0.0386833885125792;0.0386889053808951;0.0387759727616675;0.0389353449698755;0.0391578021438599;0.0394340911623749;0.0397548937957125;0.0401108276872524;0.0404924837031652;0.0408905007890713;0.0412123741190241;0.0415109822026825;0.0418047824463086;0.0418748587616473;0.0417849737965782;0.0417108114349424;0.0416504210476107;0.041512502152454;0.0412735830041486;0.0411475369020808];
x1_step2.ymin = -1;

% Layer 1
b1 = [1.596524783053703489;4.2471955501229796681;4.191838896268183845;-4.029085566299477783;-1.4007387384909304462;2.0551660232930908379;-0.97282430188818402872;-21.100917836529763605;2.7428342419535201024;0.53887351439816200127];
IW1_1 = [-1.8243793996384840561 -1.4340613168534075417 -1.2880541858438925296 -1.184530428599366747 -1.0934339939150379273 -1.008397275850227981 -0.928545148663313058 -0.85449264226259424859 -0.78717565341920059385 -0.72744061711197005593 -0.67588531747711622089 -0.63280062139739412519 -0.59816119759637975672 -0.57164402499021726989 -0.55266411165954809626 -0.54042087567143348714 -0.53395038962970187146 -0.53217964711867205008 -0.53397970494930413476 -0.53821517755268533101 -0.54378816274129382347 -0.54967526351244788696 -0.55495692261709705928 -0.55883878615210469398 -0.56066524329820233152 -0.57754926680624618651 -0.59546139374899709207 -0.60906974406495895114 -0.61856247671514352771 -0.62420508167456467685 -0.62631995354910263707 -0.62526753391670975013 -0.62142935573293678342 -0.61519320890500894805 -0.60694054314866763278 -0.59703613403705591001 -0.585819961599219452 -0.57360118826350769972 -0.56065407418546275853 -0.54721563242286486162 -0.53348480312613655308 -0.51962291363858748028 -0.50592290520192684244 -0.49868909610980161062 -0.49164591213234970501 -0.4848210777028226226 -0.47821834496432208406 -0.47182170376749793528 -0.46559937686938085433 0.60421931483549051745 0.96531648458563068527 1.0786261653390061266 1.205418374608533183 1.2817253547003273351 1.3192352425373641278 1.314986573180115581 1.2751215126097674712 1.2142933143151199982 1.1268721530668110997 1.0218073344561371396 0.91114746662707291058 0.79278350615001036417 0.67842701046904041462 0.57180630947443278345 0.46880048478823366231 0.37136340716368460013 0.28182758253441364538 0.2319219465500617916 0.21881904670771779031 0.21857580732625003783 0.22945233268800935278 0.24976449130709657553 0.27792919920122893807 0.31248317228530164691 0.36413926999276174934 0.42339090379360361238 0.48598831176145240729 0.55152849301726203368 0.61392597882560229205 0.67240308540051274555 0.72637403218462393006 0.77542875906008779108 0.81931855659142138748 0.85794299141103191886 0.8913375250483690504 0.91966120836805020922 0.94318387830845906716 0.96227238581463792055 0.97218341039124789305 0.97734289842253707636 0.98000644624877275568 0.98384351008751458334 0.98836584574748553855 0.99151449315592410372 0.9938172570012313578 0.99705072530081950699 1.0019546191017918435 1.0057991875214551403;1.057197789380174946 0.36245888980181045769 -0.21321481883688939152 -0.4939574297096542832 -0.59355669912961850354 -0.39676724381083855464 -0.035190422549877933833 0.21303245768925596626 0.22044680003034941573 0.07072005172868287004 -0.082465360142007143596 -0.16232276753814320336 -0.20434376643346799374 -0.28388733384965775253 -0.42530632482300240182 -0.58053147858511167101 -0.68257570267399880759 -0.70578048001107696052 -0.67321097633369753055 -0.61726690133332684507 -0.54370762628589131005 -0.4334763275496902879 -0.27120711293025495658 -0.065735849727102488305 0.15613491711308247201 0.29239508969155036944 0.38951531073089135093 0.47457419236636255722 0.54859199599304109274 0.60470639328906505838 0.63434746434200206533 0.63553796489046687768 0.61454374496955954665 0.58067392138420714787 0.54060511817866063744 0.49737138879808151515 0.45332239658611006572 0.41272112816446299144 0.38116805837388223477 0.36291901545200838664 0.35904438574529234929 0.36793048970874581149 0.38636757505699803605 0.38592087795967439101 0.3913967628861376169 0.39975714967219394547 0.40713628904813731202 0.40962401729619246638 0.40421521002607813111 -1.5245878020483478732 -0.17184731538694861253 -0.14751021403989625358 0.57402819350975531343 1.0345114990402317634 1.4586847384604624267 1.7504257489804229131 1.8478286672828945214 1.8666003746867598778 1.840941724476518937 1.802666136833944277 1.7003140976591124556 1.4509398933732156056 1.1196050123941363452 0.80310294018144423589 0.54807573417327382082 0.35030325197670869608 0.16164086813543981913 0.038247925559207932023 -0.02611569140787688495 -0.079752947789815897828 -0.12174134123277680075 -0.17893109139457546997 -0.28271172963319401994 -0.4435777373841630622 -0.60046265898724848764 -0.75571385533093815567 -0.90589986705649150345 -1.0421243284201062718 -1.1837756476163652231 -1.3187534017305215794 -1.4287121957852753074 -1.4988182646619321314 -1.5235648558989851598 -1.5044598460782776517 -1.4440650824383329809 -1.3432199816160010908 -1.2034357642246185094 -1.0307130555033650054 -0.84312526175613056179 -0.64966293428650012665 -0.4598685626559048667 -0.2597488318412045083 -0.066301302594897609799 0.094925275527687369426 0.21945097452997500143 0.31370156889509215326 0.38061255672888755219 0.40393300215061977987;0.33132808618759979069 0.6876050079369829815 0.2928423514038444031 -0.040595322520310013481 -0.10933604454984174881 -0.27532261675076419305 -0.53234569697818179268 -0.65986391397990828978 -0.60958252751446739826 -0.49481062292448069195 -0.42627149003865583143 -0.43707869244979791201 -0.49195552120840413401 -0.53244855353834130707 -0.52734454503437733219 -0.48959544892110107295 -0.44784380906072507322 -0.40943909583839410704 -0.35527950061532831416 -0.26480339324827872893 -0.1386342889506224918 0.0033823184865564167277 0.14128360461644598467 0.26904915395429651603 0.39183682641637901378 0.43371958449082526066 0.44884206000324172736 0.45363248217295304432 0.44527689510731688349 0.4284500876673974501 0.41094001879699793012 0.39782300810110654554 0.38977604865758758157 0.38572136167357407022 0.38585563617996543329 0.39187491514939037929 0.40485563414128683535 0.42351460266307894287 0.44460261397723732646 0.46473692581118108968 0.48178851096332520054 0.49484440649565653025 0.50264128890466797106 0.47814601917941068621 0.44865350249343183275 0.41482223368598525326 0.37836313892888867594 0.34153805818763166569 0.30649664074047705542 -1.3702938913574014279 -0.90760396094197637318 -0.14755912876772334097 0.92951066821693417719 1.8326716316208708779 2.2978745970669143261 2.3981811386509201967 2.2552170367032018383 1.9145357157138735982 1.36419139394818556 0.73876285936700281098 0.19304941923822019345 -0.24769296110538399636 -0.54355382733740031931 -0.74767396086510895525 -0.94067439382797868319 -1.1279346823286595658 -1.2858858524210030616 -1.2825762531809374867 -1.1623521009458199771 -1.0523068977687846104 -0.96958270163775517325 -0.90889171691558856558 -0.85724490305016209923 -0.81012965804984993223 -0.72580071979212068545 -0.64089518625288754983 -0.56421704058402399884 -0.48170250053235397214 -0.40631776065385677432 -0.33661816099388325307 -0.27614792102516105832 -0.22774950547734901241 -0.19017562824758596496 -0.15963295684102529748 -0.13345274400717652141 -0.11161670721116656591 -0.094920129276011455666 -0.082162948247167424953 -0.077578137204303676544 -0.069417253697425379544 -0.050134574131937024999 0.0050881350343488394514 0.091649434410091393244 0.19503555039349410039 0.31920235431130095094 0.47546203846805551452 0.66643949241620459301 0.87355387581194954283;-0.69567861392182284153 2.0462788953691841698 -0.13994332965162589733 -0.39493490547313403471 0.11504291468565996936 0.29082205253172410675 0.10787451109781720504 -0.070624943632503586755 -0.074330718375255400154 0.026621092775832615879 0.10192648406740456579 0.09635321105208760617 0.051376415943564950062 0.040491958507169030501 0.089772030761322854642 0.15816223754982819405 0.18663236741163194421 0.15503953240756890297 0.089484366861929787174 0.024921672517509489003 -0.029327028554655854009 -0.088452308948938171418 -0.1659227993279851765 -0.25470127116794771815 -0.33335609664334836522 -0.31091870596018017503 -0.24633775925127418538 -0.17536145171911288188 -0.10798118435938110216 -0.04588840862127464143 0.012481406422910672205 0.064771332097418463092 0.10356061863202743745 0.12140346462004995842 0.11605243711284721209 0.091054802221104069737 0.052414559421007582418 0.0054407347919832177441 -0.045505905767797297234 -0.095290694558304592232 -0.13699764023445629157 -0.16298032381776153543 -0.1662998894765557456 -0.11983097071319578908 -0.047342252679543540828 0.050692901061645423422 0.17300439363955882888 0.31732735442702980633 0.48008126942260664904 -6.4061448818720601039 0.22447573548622809514 0.73208183952327821054 0.71672558632654692623 0.45567159572146581636 0.074398934782505338204 -0.081305181929492792436 -0.020156786381736881142 0.015511709367612584731 0.018474065675042523199 -0.046772078864599858639 -0.12967644232731292964 -0.11077439015721800286 -0.040215151396708906373 0.017792687615205169532 0.041096698546708658462 0.039780949703485175839 0.061127006429627317452 0.048334160065494985448 0.0091162866055167490753 -0.017032958594010823988 -0.041789690243635241318 -0.050352392058425378407 -0.022422963506477683326 0.044626519529729936908 0.092942271386398586652 0.12325472036181960023 0.13435235431670486395 0.12446499696766673282 0.1161041513935691244 0.10616647103958737342 0.08658610566753320581 0.052736029025331247755 0.0080975367191850923521 -0.038680456793088714706 -0.080072278437303384679 -0.11284645266055144674 -0.13619724000992053381 -0.14830720263961422178 -0.13714982716643445149 -0.10633972424145243796 -0.059357947156116461218 -0.021027817878091194237 0.0083563581023848778478 0.039739295885334854908 0.067932660172206477123 0.078794195789391258122 0.0641969917303864962 0.039801593659107591117;-0.68548388475247024054 2.9110156713206816192 0.67949378035432372869 -0.45166436487000166666 -0.84148590306996284838 -0.81383072557593005847 -0.57253980405845072976 -0.25365772888224252801 0.052748534655338234767 0.29120719166079872542 0.4340621296877517632 0.47612540860376773022 0.4292664895641324363 0.31653202012071213201 0.16645628970764225762 0.0082049026767703221036 -0.13227340340022550325 -0.23507732144669940544 -0.28811584928301137154 -0.28774670909760508009 -0.23830246600634424903 -0.15064506346729156228 -0.040039499272548975672 0.076274579990689650444 0.18145890768408814986 0.28051479356381858743 0.34628495220638649821 0.36994177621114060495 0.3539861643971289884 0.3050395283928813428 0.23262083741740011145 0.14771923879590131978 0.06135385451280172403 -0.016722140500968915577 -0.0790604278957636325 -0.12122468298956878829 -0.14212411097505747715 -0.14396820583183081443 -0.13187946234701822257 -0.11323887233591034551 -0.096862297200930189134 -0.092110681446731110245 -0.10779651779661451882 -0.14314525060163671433 -0.21268021868343256475 -0.32002676271000662922 -0.46660540463030852898 -0.65175708757027983609 -0.87303722081646317754 4.4805676171745849601 4.246659147413116564 -0.71218086261259871961 -1.4743110712333691303 -0.85377629761328821534 0.091231049192403240733 0.92190412480213901336 1.3974545298789253778 1.4580758868651875204 1.2934438647627242158 0.9841155173829716496 0.60110131219243112533 0.24395543098134017668 -0.057235142509594834348 -0.26927370402362016399 -0.37371530129279290078 -0.37619898256542638748 -0.29167593504181366093 -0.16873137720632372383 -0.037132974786178364612 0.094036094673482423234 0.20184768690815030334 0.26967853907950833925 0.28778713163044022938 0.25327563046347456588 0.15438248810010501977 0.01207558975346413252 -0.15516078000504862633 -0.331379537722629125 -0.49502647691805617969 -0.63285579499868993558 -0.73494413886174392303 -0.79545949522311831803 -0.81303020472089493342 -0.79071253719282275085 -0.73556664882000266648 -0.6578759312321280639 -0.57008321075541912304 -0.48555320897385984003 -0.4136216885496228346 -0.36870979747152338168 -0.36061807950261437483 -0.39962303801706589024 -0.48450661307001263722 -0.60797486301316028268 -0.76439828898721529082 -0.94708624248465089757 -1.1460142308225278462 -1.3499676538151572647;-3.3841978913000305695 1.4977068807024687125 0.60235508937849224775 0.70872201011257551784 0.95335048002829969604 0.56755762727892300479 -0.23285300140165082761 -0.77117916150048115842 -0.69050016097337785226 -0.22357396452161681921 0.14627587996097130008 0.16704781373510982356 -0.032305079127134740669 -0.17561752304358835275 -0.14118352425840841047 -0.032603519309483665334 -0.012765397440627671011 -0.12138761638403908205 -0.25751063537967167072 -0.30471058470704925902 -0.24368629117463275202 -0.14602290374341012069 -0.083517367449763707521 -0.061241885180511504427 -0.033427201517154364607 -0.0016557873803242635462 0.044373453826223048513 0.074569144249713323336 0.066791855295917912372 0.033066419670309127321 -9.2502114433975997148e-05 -0.018700038287888770538 -0.028117251997681759479 -0.038853416179029390265 -0.051053330281202610741 -0.05352437662421007103 -0.03494910192810551236 0.0063764095573615158646 0.063166640134748139324 0.12686195155998192252 0.19324633708631763773 0.26125098165883864354 0.32776325052618482392 0.37213957418275478428 0.39933275900954973148 0.40270529951500949606 0.37934657900493401472 0.32875807422935282576 0.25074029334541231284 -7.4006502145875137089 2.8916455276881118941 -1.0834536263938996381 -1.4660368067437434814 -1.3504250490666165341 -1.289438130110102998 -0.90278715143966825618 -0.069774953161465300133 0.71201693617160344285 0.90631630026368292796 0.55607694348885283731 0.072246633502717760855 -0.21876717826656280619 -0.26625164860577799075 -0.26704952448084318117 -0.38658607365640335063 -0.57961178741765062572 -0.68892459890261803501 -0.56716038834461157681 -0.30041640921944695597 -0.070746258071810383394 0.055562712918120135686 0.11189326414452246961 0.16244156117478000811 0.22472669220831900661 0.27739041925620194773 0.26758254522797703112 0.19564618079081552704 0.10875059529970827754 0.042140977697360075538 0.0077359384566416684176 -0.0066631167565039646841 -0.010340834192511003803 0.0057840800816424441447 0.060117849589445014613 0.1609538362459973504 0.29802431742558793681 0.45122991166106374283 0.6047549333726267573 0.74656135864415207326 0.87734910796770781971 0.99152720409559869097 1.0816796059043367606 1.1347212126234864638 1.1441661555675957107 1.1153650217871808881 1.0583171853533959172 0.98066075622282911084 0.8825839376161049854;-0.13847889914637642739 -1.3595430951440607981 -0.77851554440900405663 -0.43892514577317809366 -0.22576979616089165592 -0.08704977365072480433 0.0051488106687144191004 0.06633479993490791482 0.10861076801781152645 0.13939204146260858463 0.1598490102777765931 0.16852642862748820618 0.16455063600399882917 0.14794917411253141748 0.11908549027830972467 0.0787802973952290847 0.028853110299541143147 -0.027634053239609962516 -0.086683715112131493052 -0.14402750047697929214 -0.19577510395448696756 -0.23878133651066399401 -0.27075442932772703086 -0.29031586591386587815 -0.29713463118561556087 -0.27054142898881283763 -0.22988034752522665261 -0.18476138622930141087 -0.13823485168382210198 -0.093087046875543033586 -0.051620188265722059817 -0.015522976034695696798 0.014215796185536448346 0.037345480351796647711 0.054301136209734153504 0.066037360448104112653 0.073776943089545854448 0.078735396496195583782 0.081873409657074916468 0.08369923363747709677 0.084124477132982350414 0.082380220066703591097 0.077147838381061498159 0.071467918354769843781 0.057739152832197736254 0.033447968285704857139 -0.0038121289182348940677 -0.056096742237281276011 -0.12489851091034154251 1.2613550608116232965 -0.81210233999698733243 -0.50109584702096288122 -0.010961242729154543549 0.29135650947691488222 0.42795900795138247519 0.45915671758643222811 0.39825752188492097305 0.27033143824503202968 0.14782738522055310915 0.031316329982097552975 -0.077716850967254183513 -0.15863749728384624049 -0.21482570609240755899 -0.24237466876394242465 -0.23614026158099446495 -0.19836093458480910656 -0.13298931485443965528 -0.065429562060383750222 -0.0033374645843147056172 0.059603430269640239603 0.11646635682372338816 0.16176478740681740631 0.19159026692869216002 0.20362773096207592571 0.1859034898127949198 0.14696725204316760105 0.093060875766476133797 0.028431007090957464978 -0.036298475004835559221 -0.095392330577818901238 -0.14360078688822333626 -0.17654645337686586393 -0.19108011794612475565 -0.1856053213989193873 -0.16030997994886556079 -0.11723167911318736756 -0.060128503811026856596 0.0058175647183408372293 0.076228959728444359301 0.14273335371472986588 0.19816819370559290991 0.2306373169904377407 0.23744061481247563661 0.22131662630637927158 0.18178715314354210175 0.11775883710707887864 0.032039049530384181019 -0.065660627667812429542;-0.76308307124377727781 -0.28912701342048113817 1.1115154893811811654 2.4231052883001216181 3.0520184575864575116 2.7991185351019205463 2.0234345992216784538 1.3163406270690327649 1.022349086013293995 1.059693273892691634 1.1416935359868753963 1.104593674741323639 1.016934590422865492 1.0310981124146583188 1.1888231685364896162 1.3804403495944834734 1.4606301124993195106 1.3734779785918427297 1.1665286013311357838 0.90875870473938813454 0.61557813635888725123 0.25148987507534054098 -0.21207496411579832007 -0.75517031726536898439 -1.322857022868115795 -1.4790509643251612548 -1.500233856460406523 -1.5178768034699834377 -1.5404204048761847012 -1.5595879677608650571 -1.5622844015138570573 -1.5470618429480111899 -1.5270582490392290431 -1.5190506694175571756 -1.5318488026506975608 -1.56466030559276148 -1.6139236686212443672 -1.679551507303032265 -1.7646517808122930138 -1.870832599989407985 -1.9951021518039886438 -2.1313964839843930754 -2.2709295981829957789 -2.2794406288534347915 -2.2937254318650932561 -2.3140435202605322829 -2.3396945569940967857 -2.3698238494567349655 -2.4046164230516127169 0.076433386147433279856 -0.71120142933170393817 0.24183160551864582577 -0.48123879307174310949 -0.5285045884109558223 -0.32209186079593776775 0.13221638847153682761 0.53238182154447055705 0.43960008400845679288 0.4090039669802411626 0.2560990139224054718 -0.0088389074141571252752 0.053317122505239351871 0.20601363584549992058 0.31486082718276847681 0.41438526360610666854 0.51647405085902919897 0.71024589472204457952 0.58279891261443739214 0.21095880164767033538 -0.095621542390416883195 -0.3574097416632625035 -0.53708353319018253824 -0.58568052891425936846 -0.49399681140017215331 -0.499980915593633779 -0.5347398516311614447 -0.57943981658206755725 -0.65459471072905028866 -0.66593026784300279886 -0.62712084491427066979 -0.56454489449074096719 -0.49847096738369239821 -0.43233893458474609295 -0.35871416090172714153 -0.27253455020456873736 -0.17740262079304086607 -0.080737582783185601887 0.014483491389504742075 0.1543251211589433125 0.31128978217206282331 0.47236149996347726043 0.52393834961510565851 0.49605991978272223619 0.47864969254988831704 0.47212684201495797032 0.43013410918434719088 0.33898836896000128505 0.30696607791757102301;2.6557996323044528175 -1.0352417579117567659 -0.65534732236500459202 -0.87520183881141433435 -1.0559058610092526553 -0.60192418189665064521 0.26451302941470433705 0.93405363874682600933 1.0635063069657990642 0.80768165012572901151 0.54481453938318358254 0.47929966523426087432 0.51576215578988759969 0.44830006320350113125 0.20501186933994514083 -0.098352903107955580442 -0.29987248643891356581 -0.34547870950584363969 -0.30549686943379544823 -0.27200754158556633699 -0.26540797007740729585 -0.23808512039908213964 -0.14710313888607765009 -0.0069069273981354588343 0.12640588771006344704 0.15898184978543572488 0.12926583409027392335 0.082144409303572557546 0.03770707459382052068 -0.007572395293819401095 -0.065918507102484119597 -0.13748638652564754148 -0.20630532297277040521 -0.25342972632220400753 -0.27088916436859683534 -0.26325029872353061799 -0.2386940279239975482 -0.20089840635136524405 -0.14911976974780422056 -0.08385390197782653654 -0.010591722627685052835 0.062115156935561778584 0.1271005495711961808 0.16580689531942210957 0.19626460585920904589 0.22054608353092139406 0.23988282398150265196 0.25556369069849788067 0.27032478636420526064 1.4747861671621571578 -1.6618042963438832693 0.02816299455686549838 -0.21184900606558249025 -0.35567609553773094078 -0.063317555649302734166 0.17424832136447146458 0.085812316802645269287 -0.073617577112893989311 -0.063559485250933550615 0.16333808149065989768 0.37983388798065254033 0.34513489485120629752 0.12202444039901820527 -0.084777029124559047379 -0.14556625192254707413 -0.086607277951632977153 -0.037137357438666335208 -0.02179045278679455841 -0.020264821962103728853 0.0047205577996541773014 0.084361552991810737079 0.17351191648981947879 0.20846702740694800227 0.17117698144341161881 0.12243392671494053581 0.093039390396867344135 0.089526711999448824186 0.09493365319414247272 0.078150134457230041596 0.04348099533804752892 0.012223680182296286362 -0.00042026113962762229673 0.0015451230174082974857 0.0024472945819168706247 -0.0085430336666403525192 -0.029649610492997066635 -0.052676217143419995503 -0.0735094421054477698 -0.10055324672456912583 -0.1337861054243988379 -0.16940469824223658435 -0.18350207771930873712 -0.17008957743270164409 -0.13471408895014960749 -0.074363445908477640578 0.019237427888489696398 0.15083031712530239887 0.31110344739232448363;-0.64127297930339666188 -0.67169024537225929805 -0.63965086198410359142 -0.61353271721941959882 -0.59672844613075104458 -0.58770959730457161818 -0.58471089535853482122 -0.58625273472394101582 -0.59114331870395164792 -0.59842339096608410109 -0.60732004369203573813 -0.61721403846110256541 -0.62761644439167729725 -0.63815072971293096415 -0.64853780103521230238 -0.65858255767355089461 -0.66816123257552206827 -0.67720922629016366834 -0.68570939714840239976 -0.69368091013682953161 -0.70116880744100107403 -0.70823447196184863284 -0.71494713143071919603 -0.72137651051076523423 -0.7275866919244626807 -0.73032005012781109343 -0.73198588748525950098 -0.73360088385938226896 -0.7351740629020405704 -0.73669589567645077377 -0.73814017394351738588 -0.73946614676022071055 -0.74062080969632215766 -0.74154125807317783359 -0.74215703446847181013 -0.74239241676933220848 -0.742168606442350276 -0.74140578750469632308 -0.74002503517412421274 -0.73795005973996752324 -0.73510877632625093447 -0.7314346952459007678 -0.72683922481283003147 -0.72024767169511250131 -0.71276423257076959583 -0.7043705831262385697 -0.69505823166553248882 -0.68482856186966933887 -0.67369273041919974787 0.56058191979421889695 1.1588502221870444764 1.3341329361153675404 1.3071802267733296787 1.2663881601874558136 1.2138502142628728731 1.1428650264306621231 1.0545933495350172659 0.96348088302327972166 0.8937837397362360381 0.84155349517075839216 0.80274616526892517143 0.77883445128120787349 0.76488103161067722002 0.75905202851103636963 0.76078590338716733932 0.76807886382578238749 0.77914545810799784586 0.78705277036346932285 0.79116754815528367306 0.79467510699061738588 0.79692632012813979792 0.79745277333190456304 0.79592889054330218102 0.79214441176810790335 0.78359271182372092213 0.77189077496094493647 0.75778623684037804686 0.74139514569449016523 0.72404077734608829342 0.70605775583142493801 0.68779809597767305185 0.66962542306886085886 0.65190921002171986487 0.63501853888276593718 0.61931506651538881236 0.60514504876451113979 0.59283045598411976407 0.58265939217978213183 0.57262951921779281506 0.56467052439729781277 0.55961805811720999326 0.55740496894150015628 0.55801075412775402729 0.56134296674566841467 0.56717237163516542875 0.57514745590159421784 0.58486705805705363481 0.59618244496424854795];

% Layer 2
b2 = [1.0699017552580032397;3.6308689257073218926;-3.5018544311721475637;2.2761278240945150841];
LW2_1 = [-2.3813482606846516632 -0.095792144638610091101 0.22717960528029848555 0.43648161154824310914 -2.5228132660316786584 -2.4346366453682661835 -0.056790767573923262024 0.71374749437119155981 -0.94743311180981271136 2.2274195620992003342;0.67110748802326758433 0.62936394890871771857 -0.60119772807997973185 2.3074564433362372284 5.9356302989682667715 6.1458510576705736028 -0.49307913346431686552 0.061822603120318717074 -2.0101414144674079054 -0.51795822026371263203;-1.2627589912523691229 2.423652782458454169 -2.3387980056202861689 0.97966245474862789777 -0.66002988511438454022 -1.0442991661040414986 0.0026687626726608413945 -5.2423003870119346814 -0.83171617614848591948 1.214117759718045253;0.79315336944772474315 3.7801406071103813566 -4.141250489075498642 -0.23059422847826854808 1.1975773992981673111 0.69656749394510730777 0.57761706786229893851 1.8390162306734740838 -1.2053785983039950747 -0.77041473792347892058];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2.0216007230893;2.00154791207371;2.00527416034525;2.00956857341751];
y1_step1.xoffset = [0.00528254041367737;0.000103482168008262;0.00154594764516558;0.0032372596172564];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
